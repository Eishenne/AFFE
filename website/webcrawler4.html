<!DOCTYPE html>
<html lang="en">

<head>

    <title>WebcrawlerAffe</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="webcrawler4.css">
    <link rel="icon" href="Affe.ico">
</head>

<!--
<body onload="nextSearchResult()">
-->

<body>



    <div class="flex-container">


    </div>
    <span style="font-size:25px;cursor:pointer;" onclick="openNav()">&#9776; </span>

    <div class="header">
        <div id="mySidenav" class="sidenav">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="About.html">Ãœber uns</a>
            <a href="Agb.html">AGB</a>
            <a href="kontakt.html">Kontakt</a>



        </div>

        <script>
            function openNav() {
                document.getElementById("mySidenav").style.width = "300px";
            }

            function closeNav() {
                document.getElementById("mySidenav").style.width = "0";
            }
        </script>

        <div> <img class="logo" src="Affe.png" alt="HTML5 Icon;" /></div>

        <div class="input-group">
            <input type="text" id="search" placeholder="Search.. " onkeyup="firstSearchResult(this.value)">
            <div class="input-group-btn">

            </div>

        </div>


    </div>

    <!--   <fieldset id=demo> -->

    <script>
        var pageNr = 0;
        var searchTerm = "";

        function firstSearchResult(term) {
            pageNr = 0;
            document.getElementById("demo").innerHTML = "";
            searchTerm = term;
            nextSearchResult();
        }

        function nextSearchResult() {
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    myObj = JSON.parse(this.responseText);
                    myObj.forEach((value, index, array) => {
                        var article = document.createElement("article");
                        document.getElementById("demo").appendChild(article);
                        /* Add H3 Header */
                        var h3 = document.createElement("h3");
                        article.appendChild(h3);
                        h3.innerHTML = value.title;
                        /* Add P mit dem Link */
                        var url = new URL(value.url);
                        var favicon = url.protocol + "//" + url.hostname + "/favicon.ico";
                        var img = document.createElement('img');
                        img.src = favicon;
                        img.style.height = "16px";
                        img.style.width = "16px";
                        console.log("URL: " + favicon);

                        var p = document.createElement("div");
                        p.appendChild(img);
                        p.classList.add("margin-top-bottom");
                        article.appendChild(p);
                        var link = document.createElement("a");
                        p.appendChild(link);
                        link.innerHTML = "  " + value.url;
                        link.setAttribute("href", value.url);
                        /* Add P mit dem Description */
                        var p = document.createElement("div");
                        p.classList.add("margin-top-bottom");
                        article.appendChild(p);
                        var disc = document.createElement("div");
                        p.appendChild(disc);
                        disc.innerHTML = value.description;

                    });
                    document.getElementById("demo").style.visibility = "visible";
                    document.getElementById("demo2").style.visibility = "visible";
                }
            };
            xmlhttp.open("GET", "searchResult.php?searchTerm=" + searchTerm + "&page=" + pageNr, true);
            xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xmlhttp.send();
            ++pageNr;
        }


    </script>



    <script>

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function () { scrollFunction() };

        function scrollFunction() {
            //Get the button
            var mybutton = document.getElementById("myBtn");
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }

        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }
    </script>

    <fieldset id=demo style="visibility:hidden;">
    </fieldset>

    <div id="demo2" style="visibility:hidden;">
        <button type="button" onclick="nextSearchResult()">
            <h4><strong>Weitere Ergebnisse</strong></h4>
        </button>
    </div>

    <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
</body>

</html>